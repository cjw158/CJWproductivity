@tailwind base;
@tailwind components;
@tailwind utilities;

/* 流光边框动画 */
@property --gradient-angle {
  syntax: '<angle>';
  initial-value: 0deg;
  inherits: false;
}

@keyframes streamingGradient {
  from { --gradient-angle: 0deg; }
  to { --gradient-angle: 360deg; }
}

/* Splash 页面 Logo 亮度动画 */
@keyframes pulse-brightness {
  0%, 100% { filter: brightness(1); }
  50% { filter: brightness(1.3); }
}

/* 呼吸动画 */
@keyframes breathing {
  0%, 100% { transform: scale(1); filter: brightness(1); box-shadow: 0 0 0 1px rgba(34,211,238,0.3), 0 12px 40px rgba(0,0,0,0.6), 0 0 30px rgba(34,211,238,0.15); }
  50% { transform: scale(1.05); filter: brightness(1.1); box-shadow: 0 0 0 1px rgba(34,211,238,0.5), 0 20px 50px rgba(0,0,0,0.8), 0 0 50px rgba(34,211,238,0.3); }
}

/* 斜向扫光动画 */
@keyframes shimmer {
  0% { transform: translateX(-150%) skewX(-25deg); }
  100% { transform: translateX(150%) skewX(-25deg); }
}

.streaming-border {
  position: relative;
}

.streaming-border::after {
  content: '';
  position: absolute;
  bottom: 0;
  left: 0;
  right: 0;
  height: 2px;
  background: linear-gradient(
    90deg,
    transparent,
    #22d3ee,
    #3b82f6,
    #a855f7,
    #ec4899,
    #f97316,
    #22d3ee,
    transparent
  );
  background-size: 200% 100%;
  animation: streamingLine 3s linear infinite;
}

@keyframes streamingLine {
  0% { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

/* 全边框流光效果 */
.streaming-frame {
  position: relative;
}

.streaming-frame::before {
  content: '';
  position: absolute;
  inset: 0;
  padding: 2px;
  border-radius: inherit;
  background: conic-gradient(
    from var(--gradient-angle),
    #22d3ee,
    #3b82f6,
    #a855f7,
    #ec4899,
    #f97316,
    #22d3ee
  );
  -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  animation: streamingGradient 3s linear infinite;
  pointer-events: none;
}

/* 灵动岛窗口 - 完全隐藏滚动条 */
html, body {
  overflow: hidden;
  scrollbar-width: none;
  -ms-overflow-style: none;
}

html::-webkit-scrollbar,
body::-webkit-scrollbar {
  display: none;
  width: 0;
  height: 0;
}

/* 隐藏滚动条工具类 */
.hide-scrollbar {
  scrollbar-width: none;
  -ms-overflow-style: none;
}
.hide-scrollbar::-webkit-scrollbar {
  display: none;
  width: 0;
  height: 0;
}

@layer base {
  /* ===== 暗黑霓虹主题 (优化版) ===== */
  :root,
  .theme-dark {
    --background: 240 10% 3%; /* 更深邃的黑 */
    --foreground: 0 0% 98%;
    --card: 240 10% 5%;
    --card-foreground: 0 0% 98%;
    --popover: 240 10% 5%;
    --popover-foreground: 0 0% 98%;
    --primary: 190 100% 50%; /* 偏蓝一点的青色 */
    --primary-foreground: 240 10% 4%;
    --secondary: 260 100% 65%;
    --secondary-foreground: 0 0% 98%;
    --muted: 240 10% 12%;
    --muted-foreground: 240 5% 65%;
    --accent: 310 100% 55%;
    --accent-foreground: 0 0% 98%;
    --destructive: 340 90% 55%;
    --destructive-foreground: 0 0% 98%;
    --border: 240 10% 15%;
    --input: 240 10% 15%;
    --ring: 190 100% 50%;
    --radius: 0.75rem;
    
    /* 主题变量 */
    --theme-bg: #030305; /* 极深空黑 */
    --theme-bg-secondary: rgba(255, 255, 255, 0.03);
    --theme-bg-card: rgba(15, 15, 20, 0.6);
    --theme-text: #FAFAFA;
    --theme-text-secondary: rgba(255, 255, 255, 0.6);
    --theme-text-muted: rgba(255, 255, 255, 0.35);
    --theme-border: rgba(255, 255, 255, 0.08);
    --theme-border-hover: rgba(255, 255, 255, 0.15);
    --theme-shadow: 0 0 30px rgba(0, 200, 255, 0.05);
    
    /* 霓虹颜色 - 优化色调 */
    --neon-cyan: #00E5FF;
    --neon-cyan-rgb: 0, 229, 255;
    --neon-pink: #F500D5;
    --neon-purple: #9D4EDD;
    --neon-green: #00FFA3;
    --neon-red: #FF0040;
    --neon-yellow: #FFEA00;
    
    /* 功能色 - 荧光感 */
    --color-inbox: #9D4EDD;
    --color-todo: #00E5FF;
    --color-doing: #FFEA00;
    --color-done: #00FFA3;
    --color-urgent: #FF0040;
    --color-important: #F500D5;
    
    /* 记录模式色 */
    --color-memo: #FFD60A;
    --color-task: #38BDF8;
  }

  /* ===== Apple 极简白主题 (商务旗舰版) ===== */
  .theme-light {
    --background: 210 40% 98%; /* 极其细腻的冷白 #F8FAFC */
    --foreground: 222 47% 11%; /* #0F172A */
    --card: 0 0% 100%;
    --card-foreground: 222 47% 11%;
    --popover: 0 0% 100%;
    --popover-foreground: 222 47% 11%;
    --primary: 221 83% 53%; /* #2563EB (Royal Blue) */
    --primary-foreground: 210 40% 98%;
    --secondary: 210 40% 96.1%;
    --secondary-foreground: 222 47% 11%;
    --muted: 210 40% 96.1%;
    --muted-foreground: 215 16% 47%;
    --accent: 210 40% 96.1%;
    --accent-foreground: 222 47% 11%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 40% 98%;
    --border: 214 32% 91%;
    --input: 214 32% 91%;
    --ring: 221 83% 53%;
    --radius: 0.5rem; /* 稍微减小圆角，更商务 */
    
    /* 主题变量 - 纸张/陶瓷质感 */
    --theme-bg: #F1F5F9; /* Slate 100 - 高级商务灰 */
    --theme-bg-secondary: #FFFFFF;
    --theme-bg-card: #FFFFFF; /* 纯白卡片 */
    --theme-text: #1E293B; /* Slate 800 - 柔和深黑 */
    --theme-text-secondary: #64748B; /* Slate 500 */
    --theme-text-muted: #94A3B8; /* Slate 400 */
    --theme-border: transparent; /* 移除卡片边框，纯靠阴影 */
    --theme-border-hover: rgba(148, 163, 184, 0.2);
    
    /* 弥散阴影体系 - 模拟环境光 */
    --theme-shadow: 
      0 1px 3px 0 rgba(0, 0, 0, 0.02),
      0 4px 6px -1px rgba(0, 0, 0, 0.02),
      0 10px 15px -3px rgba(0, 0, 0, 0.02); /* 极柔和的三层阴影 */
    
    /* 商务配色 (Matte/Solid) - 哑光质感 */
    --neon-cyan: #0284C7; /* Sky 600 - 稳重蓝 */
    --neon-pink: #E11D48; /* Rose 600 - 玫瑰红 */
    --neon-purple: #7C3AED; /* Violet 600 - 皇家紫 */
    --neon-green: #059669; /* Emerald 600 - 翡翠绿 */
    --neon-red: #DC2626; /* Red 600 */
    --neon-yellow: #D97706; /* Amber 600 - 琥珀金 */
    
    /* 功能色 - 高对比度 */
    --color-inbox: #7C3AED;
    --color-todo: #0284C7;
    --color-doing: #D97706;
    --color-done: #059669;
    --color-urgent: #DC2626;
    --color-important: #E11D48;
    
    /* 记录模式色 */
    --color-memo: #D97706;
    --color-task: #0284C7;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
    font-feature-settings: "rlig" 1, "calt" 1;
  }
}

/* 霓虹暗黑风格 & 极简白风格 */
@layer utilities {
  /* 基础玻璃效果 - 浅色版优化 */
  .glass {
    @apply backdrop-blur-xl;
    background: rgba(255, 255, 255, 0.85); /* 更高不透明度 */
    backdrop-filter: blur(12px) saturate(180%);
    box-shadow: 
      0 4px 6px -1px rgba(0, 0, 0, 0.02),
      0 2px 4px -1px rgba(0, 0, 0, 0.02);
    border: 1px solid rgba(255, 255, 255, 0.5);
  }

  .glass-dark {
    @apply backdrop-blur-xl bg-black/40 border border-white/[0.08];
    backdrop-filter: blur(24px) saturate(120%);
    box-shadow: inset 0 1px 0 0 rgba(255, 255, 255, 0.05);
  }

  /* 霓虹卡片 - 浅色模式重定义为"悬浮卡片" */
  .neon-card {
    @apply backdrop-blur-2xl rounded-2xl transition-all duration-300;
    background: var(--theme-bg-card);
    border: 1px solid var(--theme-border);
    box-shadow: var(--theme-shadow);
  }
  
  /* 浅色模式下给图标增加微弱背景 */
  .theme-light .icon-bg {
    background: #F1F5F9; /* Slate 100 */
    border-radius: 8px;
  }
  
  .theme-light .icon-bg-active {
    background: #EFF6FF; /* Blue 50 */
    color: #2563EB;
  }

  /* 暗黑模式霓虹光晕 - 增强版 */
  .theme-dark .neon-card {
    background: linear-gradient(145deg, rgba(20, 20, 25, 0.6), rgba(10, 10, 15, 0.6));
    box-shadow: 
      0 4px 30px rgba(0, 0, 0, 0.5),
      inset 0 1px 0 rgba(255, 255, 255, 0.05);
  }

  .theme-dark .neon-card:hover {
    border-color: rgba(255, 255, 255, 0.15);
    box-shadow: 
      0 0 0 1px rgba(255, 255, 255, 0.05),
      0 10px 40px -10px rgba(0, 0, 0, 0.7);
    transform: translateY(-1px);
  }

  /* 浅色模式悬停效果 - 物理上浮 */
  .theme-light .neon-card:hover {
    transform: translateY(-2px);
    background: #FFFFFF;
    box-shadow: 
      0 10px 15px -3px rgba(0, 0, 0, 0.05),
      0 4px 6px -2px rgba(0, 0, 0, 0.02);
    /* 无边框 */
  }

  /* 霓虹发光边框 - 仅暗黑模式 */
  .theme-dark .neon-border-cyan {
    border: 1px solid rgba(0, 255, 255, 0.3);
    box-shadow: 0 0 15px rgba(0, 255, 255, 0.2), inset 0 0 15px rgba(0, 255, 255, 0.05);
  }
  
  /* 浅色模式下改为左侧强调线 */
  .theme-light .neon-border-cyan {
    border: 1px solid #E2E8F0; /* Slate 200 */
    border-left: 3px solid #0284C7;
    background: #FFFFFF;
  }

  .theme-dark .neon-border-pink {
    border: 1px solid rgba(255, 0, 255, 0.3);
    box-shadow: 0 0 15px rgba(255, 0, 255, 0.2), inset 0 0 15px rgba(255, 0, 255, 0.05);
  }
  
  .theme-light .neon-border-pink {
    border: 1px solid #E2E8F0;
    border-left: 3px solid #E11D48;
    background: #FFFFFF;
  }
  
  /* ... 其他颜色的浅色模式适配 ... */

  /* 霓虹文字发光 - 仅暗黑模式 */
  .theme-dark .neon-text-cyan {
    color: #00FFFF;
    text-shadow: 0 0 10px #00FFFF, 0 0 20px #00FFFF, 0 0 40px #00FFFF;
  }

  /* 浅色模式文字 - 加粗/加深 */
  .theme-light .neon-text-cyan {
    color: #0284C7;
    font-weight: 600;
  }

  .neon-text-pink {
    color: #FF00FF;
    text-shadow: 0 0 10px #FF00FF, 0 0 20px #FF00FF;
  }

  .theme-light .neon-text-pink {
    color: #E11D48;
    font-weight: 600;
    text-shadow: none;
  }

  .neon-text-green {
    color: #00FF88;
    text-shadow: 0 0 10px #00FF88, 0 0 20px #00FF88;
  }

  .theme-light .neon-text-green {
    color: #059669;
    font-weight: 600;
    text-shadow: none;
  }

  /* Spotlight 聚光灯 - 霓虹版 */
  .spotlight-container {
    @apply backdrop-blur-2xl bg-black/80 rounded-2xl p-6;
    border: 1px solid rgba(0, 255, 255, 0.2);
    box-shadow: 
      0 0 0 1px rgba(0, 255, 255, 0.1),
      0 0 60px rgba(0, 255, 255, 0.1),
      0 25px 50px -12px rgba(0, 0, 0, 0.8),
      inset 0 1px 0 rgba(255, 255, 255, 0.05);
  }
  
  /* 浅色版容器 - 极简投影 */
  .theme-light .spotlight-container {
    @apply bg-white rounded-xl p-6;
    border: 1px solid #F1F5F9;
    box-shadow: 
      0 20px 25px -5px rgba(0, 0, 0, 0.05),
      0 10px 10px -5px rgba(0, 0, 0, 0.02);
  }

  /* 看板列 - 霓虹风格 */
  .kanban-column {
    @apply backdrop-blur-xl bg-black/40 rounded-2xl;
    border: 1px solid rgba(255, 255, 255, 0.05);
  }
  
  .theme-light .kanban-column {
    @apply bg-white/50 rounded-xl;
    border: 1px solid rgba(0,0,0,0.02);
  }

  .kanban-column-inbox {
    border-left: 3px solid #8B5CF6;
    box-shadow: -5px 0 20px rgba(139, 92, 246, 0.2);
  }
  
  .theme-light .kanban-column-inbox {
    border-left: 3px solid #7C3AED;
    box-shadow: none;
    background: linear-gradient(to bottom, rgba(124, 58, 237, 0.02), transparent);
  }

  .kanban-column-todo {
    border-left: 3px solid #00FFFF;
    box-shadow: -5px 0 20px rgba(0, 255, 255, 0.2);
  }
  
  .theme-light .kanban-column-todo {
    border-left: 3px solid #0284C7;
    box-shadow: none;
    background: linear-gradient(to bottom, rgba(2, 132, 199, 0.02), transparent);
  }

  .kanban-column-doing {
    border-left: 3px solid #FFEE00;
    box-shadow: -5px 0 20px rgba(255, 238, 0, 0.3), 0 0 40px rgba(255, 238, 0, 0.1);
    background: rgba(255, 238, 0, 0.03);
  }
  
  .theme-light .kanban-column-doing {
    border-left: 3px solid #D97706;
    box-shadow: none;
    background: linear-gradient(to bottom, rgba(217, 119, 6, 0.02), transparent);
  }

  .kanban-column-done {
    border-left: 3px solid #00FF88;
    box-shadow: -5px 0 20px rgba(0, 255, 136, 0.2);
  }
  
  .theme-light .kanban-column-done {
    border-left: 3px solid #059669;
    box-shadow: none;
    background: linear-gradient(to bottom, rgba(5, 150, 105, 0.02), transparent);
  }

  /* 四象限 - 霓虹风格 */
  .quadrant-urgent-important {
    border-left: 3px solid #FF0055;
    box-shadow: -5px 0 25px rgba(255, 0, 85, 0.2), 0 0 30px rgba(255, 0, 85, 0.1);
    background: rgba(255, 0, 85, 0.05);
  }
  
  .theme-light .quadrant-urgent-important {
    border-left: 3px solid #E11D48;
    box-shadow: none;
    background: #FFF1F2; /* Rose 50 */
  }

  .quadrant-important {
    border-left: 3px solid #00FFFF;
    box-shadow: -5px 0 25px rgba(0, 255, 255, 0.2);
    background: rgba(0, 255, 255, 0.03);
  }
  
  .theme-light .quadrant-important {
    border-left: 3px solid #0284C7;
    box-shadow: none;
    background: #F0F9FF; /* Sky 50 */
  }

  .quadrant-urgent {
    border-left: 3px solid #FFEE00;
    box-shadow: -5px 0 25px rgba(255, 238, 0, 0.2);
    background: rgba(255, 238, 0, 0.03);
  }
  
  .theme-light .quadrant-urgent {
    border-left: 3px solid #D97706;
    box-shadow: none;
    background: #FFFBEB; /* Amber 50 */
  }

  .quadrant-neither {
    border-left: 3px solid #8B5CF6;
    box-shadow: -5px 0 25px rgba(139, 92, 246, 0.15);
    background: rgba(139, 92, 246, 0.02);
  }
  
  .theme-light .quadrant-neither {
    border-left: 3px solid #7C3AED;
    box-shadow: none;
    background: #F5F3FF; /* Violet 50 */
  }

  /* 日历 - 霓虹边框 */
  .calendar-container {
    border-left: 3px solid #00FFFF;
    box-shadow: -5px 0 25px rgba(0, 255, 255, 0.15), 0 0 30px rgba(0, 255, 255, 0.05);
  }
  
  .theme-light .calendar-container {
    border-left: 3px solid #0284C7;
    box-shadow: 
      -10px 0 30px -5px rgba(0, 0, 0, 0.03);
  }

  /* 任务卡片 - 霓虹风格 */
  .task-item {
    @apply rounded-xl p-3 cursor-grab active:cursor-grabbing transition-all duration-200;
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.05);
  }

  .theme-light .task-item {
    background: #FFFFFF;
    border: 1px solid #F1F5F9;
    box-shadow: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
  }

  .task-item:hover {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(0, 255, 255, 0.2);
    box-shadow: 0 0 20px rgba(0, 255, 255, 0.1);
  }

  .theme-light .task-item:hover {
    background: #FFFFFF;
    border-color: #E2E8F0;
    box-shadow: 
      0 4px 6px -1px rgba(0, 0, 0, 0.05),
      0 2px 4px -1px rgba(0, 0, 0, 0.03);
    transform: translateY(-1px);
  }

  .task-item-dragging {
    @apply scale-105 z-50;
    border-color: rgba(0, 255, 255, 0.4);
    box-shadow: 0 0 30px rgba(0, 255, 255, 0.3), 0 20px 40px rgba(0, 0, 0, 0.5);
  }

  .theme-light .task-item-dragging {
    border-color: #0284C7;
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
    background: #FFFFFF;
  }

  /* 进度条 - 霓虹风格 */
  .neon-progress {
    @apply h-1 rounded-full overflow-hidden;
    background: rgba(255, 255, 255, 0.1);
  }
  
  .theme-light .neon-progress {
    background: #E2E8F0;
  }

  .neon-progress-bar {
    @apply h-full rounded-full;
    background: linear-gradient(90deg, #00FFFF, #FF00FF);
    box-shadow: 0 0 10px rgba(0, 255, 255, 0.5);
  }
  
  .theme-light .neon-progress-bar {
    background: #0284C7;
    box-shadow: none;
  }

  /* 霓虹按钮 */
  .neon-button {
    @apply px-4 py-2 rounded-lg font-medium transition-all duration-200;
    background: rgba(0, 255, 255, 0.1);
    border: 1px solid rgba(0, 255, 255, 0.3);
    color: #00FFFF;
  }
  
  .theme-light .neon-button {
    background: #F0F9FF; /* Sky 50 */
    border: 1px solid #BAE6FD; /* Sky 200 */
    color: #0369A1; /* Sky 700 */
  }

  .neon-button:hover {
    background: rgba(0, 255, 255, 0.2);
    box-shadow: 0 0 20px rgba(0, 255, 255, 0.3);
  }
  
  .theme-light .neon-button:hover {
    background: #E0F2FE; /* Sky 100 */
    box-shadow: 0 2px 4px rgba(0,0,0,0.05);
  }

  /* 滚动条 - 霓虹风格 (深色模式) */
  .theme-dark .custom-scrollbar::-webkit-scrollbar-thumb {
    background: linear-gradient(180deg, rgba(0, 255, 255, 0.3), rgba(255, 0, 255, 0.3));
    border-radius: 4px;
  }

  .theme-dark .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: linear-gradient(180deg, rgba(0, 255, 255, 0.5), rgba(255, 0, 255, 0.5));
  }

  /* 滚动条 - 极简风格 (浅色模式) */
  .theme-light .custom-scrollbar::-webkit-scrollbar-thumb {
    background: #CBD5E1; /* Slate 300 */
    border-radius: 4px;
  }

  .theme-light .custom-scrollbar::-webkit-scrollbar-thumb:hover {
    background: #94A3B8; /* Slate 400 */
  }

  .custom-scrollbar::-webkit-scrollbar {
    width: 6px; /* 稍微加宽一点点方便点击 */
    height: 6px;
  }

  .custom-scrollbar::-webkit-scrollbar-track {
    background: transparent;
  }

  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }

  /* 玻璃卡片兼容 */
  .glass-card {
    @apply neon-card;
  }
}

/* Animation classes */
@layer utilities {
  .animate-spring {
    animation-timing-function: cubic-bezier(0.175, 0.885, 0.32, 1.275);
  }
}

/* ===== 暗色主题背景 ===== */
.theme-dark .bg-grid-pattern {
  background-size: 50px 50px;
  background-image: 
    linear-gradient(to right, rgba(255, 255, 255, 0.03) 1px, transparent 1px),
    linear-gradient(to bottom, rgba(255, 255, 255, 0.03) 1px, transparent 1px);
  mask-image: radial-gradient(circle at center, black 40%, transparent 100%);
  will-change: transform;
  transform: translateZ(0);
}

/* ===== 浅色主题背景 ===== */
.theme-light .bg-grid-pattern {
  background: none;
}

/* 流光动画 - GPU 加速 */
@keyframes shimmer {
  0% { transform: translateX(-100%) skewX(-20deg); }
  100% { transform: translateX(200%) skewX(-20deg); }
}

/* 多彩流光动画 */
@keyframes aurora {
  0%, 100% {
    background-position: 0% 50%;
    opacity: 0.3;
  }
  25% {
    background-position: 50% 100%;
    opacity: 0.5;
  }
  50% {
    background-position: 100% 50%;
    opacity: 0.4;
  }
  75% {
    background-position: 50% 0%;
    opacity: 0.6;
  }
}

@keyframes flow {
  0% { transform: translateX(-100%) rotate(0deg); }
  100% { transform: translateX(100%) rotate(3deg); }
}

.theme-dark .shimmer-effect::after {
  content: "";
  position: absolute;
  inset: 0;
  background: linear-gradient(
    90deg, 
    transparent,
    rgba(0, 255, 255, 0.08),
    rgba(139, 92, 246, 0.08),
    rgba(255, 0, 255, 0.06),
    rgba(0, 255, 136, 0.08),
    transparent
  );
  background-size: 200% 100%;
  animation: shimmer 4s infinite, aurora 8s ease-in-out infinite;
  will-change: transform, opacity;
  pointer-events: none;
}

/* 多彩极光背景效果 */
.theme-dark .aurora-bg {
  position: relative;
  overflow: hidden;
}

.theme-dark .aurora-bg::before {
  content: "";
  position: absolute;
  inset: -50%;
  background: 
    radial-gradient(ellipse at 20% 20%, rgba(0, 255, 255, 0.15) 0%, transparent 50%),
    radial-gradient(ellipse at 80% 80%, rgba(139, 92, 246, 0.12) 0%, transparent 50%),
    radial-gradient(ellipse at 40% 80%, rgba(255, 0, 255, 0.1) 0%, transparent 40%),
    radial-gradient(ellipse at 80% 20%, rgba(0, 255, 136, 0.1) 0%, transparent 45%);
  animation: aurora 15s ease-in-out infinite;
  pointer-events: none;
  z-index: 0;
}

/* 霓虹流光边框 */
.theme-dark .neon-flow {
  position: relative;
}

.theme-dark .neon-flow::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  padding: 1px;
  background: linear-gradient(
    90deg,
    rgba(0, 255, 255, 0.5),
    rgba(139, 92, 246, 0.5),
    rgba(255, 0, 255, 0.5),
    rgba(255, 238, 0, 0.5),
    rgba(0, 255, 136, 0.5),
    rgba(0, 255, 255, 0.5)
  );
  background-size: 300% 100%;
  animation: flow 3s linear infinite;
  -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
  -webkit-mask-composite: xor;
  mask-composite: exclude;
  pointer-events: none;
}

/* ===== 主题通用样式 ===== */
.theme-bg {
  background-color: var(--theme-bg);
}

.theme-text {
  color: var(--theme-text);
}

.theme-text-secondary {
  color: var(--theme-text-secondary);
}

.theme-text-muted {
  color: var(--theme-text-muted);
}

.theme-border {
  border-color: var(--theme-border);
}

.theme-card {
  background-color: var(--theme-bg-card);
  border: 1px solid var(--theme-border);
}

/* 浅色主题卡片阴影 - 更立体 */
.theme-light .theme-card {
  box-shadow: 
    0 4px 20px rgba(0, 0, 0, 0.03),
    0 1px 2px rgba(0, 0, 0, 0.04),
    inset 0 0 0 1px rgba(0, 0, 0, 0.02); /* 内描边增强质感 */
}

/* 暗色主题发光效果 */
.theme-dark .glow-effect {
  box-shadow: var(--theme-shadow);
}
.dragging * {
  user-select: none;
}

/* Transparent window background for spotlight */
.spotlight-window {
  background: transparent !important;
}

/* Dashboard Grid Layout - 自适应 16:9 / 16:10 全屏 */
.bento-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  grid-template-rows: repeat(2, 1fr);
  gap: clamp(0.75rem, 1.5vw, 1.5rem);
  height: 100%;
  width: 100%;
  max-width: min(1600px, 95vw);
  max-height: calc(100vh - 120px); /* 预留 header 空间 */
  margin: 0 auto;
  padding: clamp(0.5rem, 1vw, 1rem);
}

/* 超宽屏优化 (21:9 等) */
@media (min-aspect-ratio: 2/1) {
  .bento-grid {
    max-width: min(1800px, 85vw);
    gap: 2rem;
  }
}

/* 16:9 屏幕优化 */
@media (min-aspect-ratio: 16/9) and (max-aspect-ratio: 2/1) {
  .bento-grid {
    max-width: min(1600px, 92vw);
  }
}

/* 16:10 屏幕优化 */
@media (min-aspect-ratio: 3/2) and (max-aspect-ratio: 16/9) {
  .bento-grid {
    max-width: min(1500px, 90vw);
  }
}

/* 4:3 及更方屏幕 */
@media (max-aspect-ratio: 3/2) {
  .bento-grid {
    max-width: min(1400px, 95vw);
  }
}

/* 小屏幕响应式 */
@media (max-width: 1024px) {
  .bento-grid {
    gap: 0.75rem;
    padding: 0.5rem;
  }
}

@media (max-width: 768px) {
  .bento-grid {
    grid-template-columns: 1fr;
    grid-template-rows: repeat(4, minmax(180px, 1fr));
    gap: 0.5rem;
    max-height: none;
  }
}

/* 高分辨率优化 */
@media (min-width: 1920px) {
  .bento-grid {
    max-width: 1700px;
    gap: 1.75rem;
  }
}

@media (min-width: 2560px) {
  .bento-grid {
    max-width: 2000px;
    gap: 2rem;
  }
}

/* Wallpaper preview container */
.wallpaper-preview {
  @apply relative overflow-hidden rounded-xl;
  aspect-ratio: 16 / 9;
}

.wallpaper-preview img {
  @apply w-full h-full object-cover;
}

/* Memo Wall Masonry 响应式布局 */
.memo-masonry {
  column-count: 1;
}

@media (min-width: 640px) {
  .memo-masonry {
    column-count: 2;
  }
}

@media (min-width: 1024px) {
  .memo-masonry {
    column-count: 3;
  }
}

@media (min-width: 1280px) {
  .memo-masonry {
    column-count: 4;
  }
}

/* TipTap 编辑器样式 */
.ProseMirror {
  outline: none;
}

.ProseMirror p.is-editor-empty:first-child::before {
  content: attr(data-placeholder);
  float: left;
  pointer-events: none;
  height: 0;
}

.theme-dark .ProseMirror p.is-editor-empty:first-child::before {
  color: rgba(255, 255, 255, 0.3);
}

.theme-light .ProseMirror p.is-editor-empty:first-child::before {
  color: rgba(0, 0, 0, 0.3);
}

.ProseMirror > * + * {
  margin-top: 0.5em;
}

.ProseMirror ul,
.ProseMirror ol {
  padding-left: 1.5em;
}

.ProseMirror ul {
  list-style-type: disc;
}

.ProseMirror ol {
  list-style-type: decimal;
}

.ProseMirror code {
  background-color: rgba(0, 0, 0, 0.1);
  border-radius: 0.25em;
  padding: 0.1em 0.3em;
  font-family: ui-monospace, monospace;
  font-size: 0.9em;
}

.theme-dark .ProseMirror code {
  background-color: rgba(255, 255, 255, 0.1);
}

.ProseMirror pre {
  background-color: rgba(0, 0, 0, 0.05);
  border-radius: 0.5em;
  padding: 0.75em 1em;
  font-family: ui-monospace, monospace;
  font-size: 0.9em;
  overflow-x: auto;
}

.theme-dark .ProseMirror pre {
  background-color: rgba(255, 255, 255, 0.05);
}

.ProseMirror blockquote {
  border-left: 3px solid rgba(0, 0, 0, 0.1);
  padding-left: 1em;
  margin-left: 0;
  font-style: italic;
}

.theme-dark .ProseMirror blockquote {
  border-left-color: rgba(255, 255, 255, 0.2);
}

/* ===== 设置功能支持 ===== */

/* 禁用动画 */
.reduce-motion,
.reduce-motion * {
  animation-duration: 0.01ms !important;
  animation-iteration-count: 1 !important;
  transition-duration: 0.01ms !important;
}

/* 禁用毛玻璃效果 */
.no-glass .glass,
.no-glass .glass-dark,
.no-glass .backdrop-blur-xl,
.no-glass .backdrop-blur-2xl,
.no-glass .backdrop-blur-sm,
.no-glass [class*="backdrop-blur"] {
  backdrop-filter: none !important;
  -webkit-backdrop-filter: none !important;
}

.no-glass .neon-card {
  background: rgba(0, 0, 0, 0.9) !important;
}

.no-glass.theme-light .neon-card {
  background: rgba(255, 255, 255, 0.95) !important;
}

/* 字体大小变量支持 */
:root {
  --base-font-size: 16px;
}

html {
  font-size: var(--base-font-size) !important;
}

body {
  font-size: inherit !important;
}

/* 强调色支持 */
:root {
  --accent-color: #00FFFF;
}

/* ===== 数学公式样式 - 霓虹发光风格 ===== */

/* 行内公式 - 无背景，发光字体 */
.math-inline {
  display: inline-block;
  padding: 0 3px;
  margin: 0 1px;
  vertical-align: baseline;
  cursor: default;
  user-select: none;
}

/* 浅色主题：使用深色强调 */
.theme-light .math-inline .katex {
  color: #0891b2; /* cyan-600 */
}

/* 深色主题：霓虹发光效果 */
.theme-dark .math-inline .katex {
  color: #22d3ee; /* cyan-400 */
  text-shadow: 0 0 8px rgba(34, 211, 238, 0.4);
}

/* 块级公式 - 玻璃面板 */
.math-block {
  display: block;
  padding: 20px 32px;
  margin: 24px 0;
  text-align: center;
  border-radius: 12px;
  overflow-x: auto;
  cursor: default;
  user-select: none;
}

/* 浅色主题块级公式 */
.theme-light .math-block {
  background: linear-gradient(135deg, rgba(8, 145, 178, 0.03), rgba(6, 182, 212, 0.05));
  border: 1px solid rgba(8, 145, 178, 0.1);
}

/* 深色主题块级公式 - 全息玻璃 */
.theme-dark .math-block {
  background: linear-gradient(135deg, rgba(34, 211, 238, 0.03), rgba(168, 85, 247, 0.03));
  border: 1px solid rgba(34, 211, 238, 0.15);
  box-shadow: 
    0 0 20px rgba(34, 211, 238, 0.05),
    inset 0 1px 0 rgba(255, 255, 255, 0.05);
}

/* 块级公式发光 */
.theme-dark .math-block .katex {
  color: #e0f2fe; /* sky-100 */
  text-shadow: 0 0 12px rgba(34, 211, 238, 0.3);
}

.theme-light .math-block .katex {
  color: #164e63; /* cyan-900 */
}

/* 公式渲染错误样式 */
.math-error {
  color: #ef4444;
  font-family: monospace;
  font-size: 0.875em;
  padding: 2px 6px;
  background: rgba(239, 68, 68, 0.1);
  border-radius: 4px;
}

/* KaTeX 字号 */
.katex {
  font-size: 1.05em;
}

.math-block .katex {
  font-size: 1.15em;
}

/* ===== 笔记编辑器滚动条 - 主题匹配 ===== */

/* 笔记编辑器专用滚动条 */
.notes-scrollbar {
  scrollbar-width: thin;
  scrollbar-color: rgba(100, 100, 100, 0.3) transparent;
}

.notes-scrollbar::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

.notes-scrollbar::-webkit-scrollbar-track {
  background: transparent;
  border-radius: 4px;
}

/* 浅色主题滚动条 */
.theme-light .notes-scrollbar::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, #cbd5e1, #94a3b8);
  border-radius: 4px;
  border: 2px solid transparent;
  background-clip: padding-box;
}

.theme-light .notes-scrollbar::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(180deg, #94a3b8, #64748b);
  background-clip: padding-box;
}

/* 深色主题滚动条 - 霓虹渐变 */
.theme-dark .notes-scrollbar::-webkit-scrollbar-thumb {
  background: linear-gradient(180deg, 
    rgba(34, 211, 238, 0.4), 
    rgba(168, 85, 247, 0.4)
  );
  border-radius: 4px;
  border: 2px solid transparent;
  background-clip: padding-box;
}

.theme-dark .notes-scrollbar::-webkit-scrollbar-thumb:hover {
  background: linear-gradient(180deg, 
    rgba(34, 211, 238, 0.6), 
    rgba(168, 85, 247, 0.6)
  );
  background-clip: padding-box;
}

/* ===== 笔记阅读模式玻璃面板 ===== */

.notes-reading-panel {
  position: relative;
}

/* 深色主题：全息玻璃效果 */
.theme-dark .notes-reading-panel::before {
  content: '';
  position: absolute;
  inset: 0;
  background: rgba(10, 10, 15, 0.4);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border-radius: 16px;
  pointer-events: none;
  z-index: -1;
  box-shadow: 0 8px 32px 0 rgba(0, 0, 0, 0.3);
  border: 1px solid rgba(255, 255, 255, 0.05);
}

/* 浅色主题：实体纸张效果 */
.theme-light .notes-reading-panel::before {
  content: '';
  position: absolute;
  inset: 0;
  background: rgba(255, 255, 255, 0.85);
  backdrop-filter: blur(12px);
  -webkit-backdrop-filter: blur(12px);
  border-radius: 16px;
  pointer-events: none;
  z-index: -1;
  box-shadow: 
    0 4px 6px -1px rgba(0, 0, 0, 0.05),
    0 10px 15px -3px rgba(0, 0, 0, 0.05),
    0 0 0 1px rgba(0, 0, 0, 0.03); /* 模拟微边框 */
}

/* 禁用玻璃效果时的降级 */
.no-glass .notes-reading-panel::before {
  backdrop-filter: none;
  -webkit-backdrop-filter: none;
  background: rgba(10, 10, 15, 0.8);
}

.no-glass.theme-light .notes-reading-panel::before {
  background: rgba(255, 255, 255, 0.9);
}
